# SNMP v2 Monitoring Scheme for MikroTik via Zabbix

## 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SNMP v2 –Ω–∞ MikroTik

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç—å SNMP –Ω–∞ MikroTik
```bash
/snmp set enabled=yes
```

### –®–∞–≥ 2: –£–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç, –ª–æ–∫–∞—Ü–∏—é –∏ –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
```bash
/snmp set contact="–ê–¥–º–∏–Ω" location="Data Center A" name="RTK_GW01"
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º—å—é–Ω–∏—Ç–∏
```bash
/snmp community add name=public addresses=0.0.0.0/0 read-access=yes
```

- **–í–∞–∂–Ω–æ:** —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IP-–∞–¥—Ä–µ—Å Zabbix-—Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–µ—à—ë–Ω –≤ firewall MikroTik –¥–ª—è SNMP.

## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ snmp –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ OID

### Debian/Ubuntu:
```bash
sudo apt update && sudo apt install snmp snmp-mibs-downloader -y
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ OID:
```bash
snmpwalk -v2c -c public 192.168.88.1
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ OID:
```bash
snmpget -v2c -c public 192.168.88.1 .1.3.6.1.2.1.1.3.0
```

## 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ SNMP-—É–∑–ª–∞ –≤ Zabbix

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Configuration ‚Üí Hosts
2. –ù–∞–∂–∞—Ç—å "Create Host"
3. –£–∫–∞–∑–∞—Ç—å:
   - –ò–º—è —Ö–æ—Å—Ç–∞: `RTK_GW01`
   - –ì—Ä—É–ø–ø—É: –Ω–∞–ø—Ä–∏–º–µ—Ä `Network Devices`
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `SNMP`, IP-–∞–¥—Ä–µ—Å MikroTik
4. –ü–µ—Ä–µ–π—Ç–∏ –≤–æ –≤–∫–ª–∞–¥–∫—É "Templates" –∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —à–∞–±–ª–æ–Ω `Template Net SNMP Generic`

## 4. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ Item –∏ Trigger

### Item (–∫–ª—é—á):
```
custom.matht04.custom.xlebokominat
```
- –¢–∏–ø: `SNMPv2 agent`
- SNMP OID: **(—É–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–π OID, –Ω–∞–ø—Ä–∏–º–µ—Ä, .1.3.6.1.x.x)**
- –¢–∏–ø –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: Numeric (unsigned)
- –ü—Ä–æ—Ç–æ—Ç–∏–ø Item —Å–æ–∑–¥–∞–Ω –≤—Ä—É—á–Ω—É—é

### –ó–Ω–∞—á–µ–Ω–∏—è:
- `1` = Up
- `2` = Down

### Trigger:
```
last(/RTK_GW01/custom.matht04.custom.xlebokominat,#3)=2
```
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 3 –∑–Ω–∞—á–µ–Ω–∏–π
- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –µ—Å–ª–∏ 3 –ø–æ–¥—Ä—è–¥ ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ "2" (Down)

## 5. –û–±—â–∞—è —Å—Ö–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

- **MikroTik** –æ—Ç–¥–∞—ë—Ç SNMP-–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º OID'–∞–º.
- **Zabbix Server** –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ SNMPv2.
- **Item** –≤ Zabbix –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É OID.
- **Trigger** —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ –∏–ª–∏ —Å—Ç–∞—Ç—É—Å–µ "Down".
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Action –≤ Zabbix.

---

> üîß –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤–æ, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ –∏ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–∏–ø–æ–≤–æ–≥–æ SNMP-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–∏–∫—Ä–æ—Ç–∏–∫–æ–≤ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ —É—Ä–æ–≤–Ω—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è.

